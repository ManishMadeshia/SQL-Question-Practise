Q1. Query all columns for all American cities in theCITY table with populations larger than 100000.The CountryCode for America is USA.
>> select * from City 
  where Population > 100000


Q2. Query the NAME field for all American cities inthe CITY table with populations larger than 120000.The CountryCode for America is USA.
>>  select name from City 
  where Population > 120000

Q3.Query all columns (attributes) for every row in the CITY table.
>> Select * from City 

Q4. Query all columns for a city in CITY with theID 1661.
>> Select * from City where ID = 1661

Q5. Query all attributes of every Japanese city in the CITY table. The COUNTRYCODE for Japan isJPN.
>> Select * from City WHERE CountryCode = 'JPN'

Q6.Query the names of all the Japanese cities inthe CITY table. The COUNTRYCODE for Japan isJPN.
>> Select Name from City WHERE CountryCode = 'JPN'

Q7.Query a list of CITY and STATE from the STATIONtable.
>> Select city, State from Station

Q8. Query a list of CITY names from STATION for citiesthat have an even ID number. Print the results
in any order, but exclude duplicates from the answer.
>> Select Distinct City from Station
where id%2==0

Q9. Find the difference between the total number of CITY entries in the table and the number ofdistinct CITY entries in the table
>> Select Count(city) - count(distinct city) as difference from Station

Q10.Query the two cities in STATION with the shortestand longest CITY names, as well as theirrespective lengths (i.e.: number of characters in the name). If there is more than one smallestor largest city, choose the one that comes first when ordered alphabetically.
>> 

11 . Query the list of CITY names starting with vowels(i.e., a, e, i, o, or u) from STATION. Your resultcannot contain duplicates.
>> Select distinct city from station
where city like 'a%'
or city like 'e%'
or city like 'i%'
or city like 'o%'
or city like 'u%'
order by city asc

12 . Query the list of CITY names ending with vowels(a, e, i, o, u) from STATION. Your result cannotcontain duplicates.
>> Select distinct city from station
where city like '%a'
or city like '%e'
or city like '%i'
or city like '%o'
or city like '%u'
order by city asc

13. Query the list of CITY names from STATION thatdo not start with vowels. Your result cannotcontain duplicates.
>> Select Distinct city from station
where city not REGEXP '^[aeiouAEIOU]'


 Q15.Query the list of CITY names from STATION thateither do not start with vowels or do not endwith vowels. Your result cannot contain duplicates.
>> select distinct city from Station
where city not( (city LIKE 'A%' OR city LIKE 'E%' OR city LIKE 'I%' OR city LIKE 'O%' OR city LIKE 'U%')
and 
(city LIKE '%a' OR city LIKE '%e' OR city LIKE '%i' OR city LIKE '%o' OR city LIKE '%u') )
order by city

Q.16 Write an SQL query that reports the products that were only sold in the first quarter of 2019. That is,
between 2019-01-01 and 2019-03-31 inclusive.
Return the result table in any order.

>> select product_id, product_name, unit_price from Product where product_id  in (
select product_id from Sales 
where sale_date between '2019-01-01' and '2019-03-31')

Q. 17 Write an SQL query to find all the authors that viewed at least one of their own articles.
Return the result table sorted by id in ascending order.
>> 
select distinct author_id as id from Views
where author_id = viewer_id 
order by author_id asc;

Q.18 If the customer's preferred delivery date is the same as the order date, then the order is called
immediately; otherwise, it is called scheduled.
Write an SQL query to find the percentage of immediate orders in the table, rounded to 2 decimal
places.

>> select  customer_id,  order_date, customer_pref_delivery_date 
when Delivery order_date = customer_pref_delivery_date  Then 'immediately'
else 'Schedule'
end as delivery

Q.19 Write an SQL query to find the ctr of each Ad. Round ctr to two decimal points.
Return the result table ordered by ctr in descending order and by ad_id in ascending order in case of a
tie.

>> select ad_id,
	IFNULL(
			Round(
				Avg(
					Case
						When action = 'Clicked' Then 1
						When action = 'Viewed' Then 0
						Else Null
					End
						) * 100,
                        2), 
                        0) As Ctr
from Ads
GROUP BY ad_id
ORDER BY ctr DESC, ad_id ASC;

Q24.Write an SQL query to report the first login date for each player.

>>>
create table if not exists activity(
	player_id int,
    device_id int,
    event_date date,
    games_played int,
    constraint pk primary key (player_id, event_date)
) 

INSERT into Activity values
(1,2,'2016-03-01',5),(1,2,'2016-05-02',6),(2,3,'2017-06-25',1),(3,1,'2016-03-02',0),(3,4,'2018-07-03',5);

select * from
(select *,
	row_number() over(partition by player_id order by event_date) as row_num
from activity) t where t.row_num = 1


Q25. Write an SQL query to report the device that is first logged in for each player.
Return the result table in any order.

>>> select player_id, device_id from (
select *,
	row_number() over(partition by player_id order by event_date) as row_num
from activity) as t where t.row_num = 1


Q. 26 Write an SQL query to get the names of products that have at least 100 units ordered in February 2020
and their amount.
Return result table in any order


>>  create table if not exists Products
(
	product_id int,
    product_name Varchar(50),
    product_category Varchar(50),
    constraint pk Primary key (product_id)
)

create table if not exists Orders
(
	product_id int,
    order_date date,
    unit int,
    constraint fk Foreign key (product_id) references Products(product_id)
)

insert into Products values (1,'Leetcode Solutions','Book'),(2,'Jewels of Stringology','Book'),(3,'HP','Laptop'),(4,'Lenovo','Laptop'),(5,'Leetcode Kit','T-shirt');

insert into Orders values(1,'2020-02-05',60),(1,'2020-02-10',70),(2,'2020-01-18',30),(2,'2020-02-11',80),(3,'2020-02-17',2),(3,'2020-02-24',3),(4,'2020-03-01',20),(4,'2020-03-04',30),(4,'2020-03-04',60),(5,'2020-02-25',50),(5,'2020-02-27',50),(5,'2020-03-01',50);


select * from Orders;
select * from Products;


select 
	p.product_name,
    sum(o.unit) as unit
from Products p left join Orders o on p.product_id = o.product_id
where o.order_date between '2020-02-01' and '2020-02-29'
group by p.product_id
having  sum(o.unit)  >=100


Q. 27 

